[
    {
      "type": "index-pattern",
      "id": "awswaf",
      "attributes": {
        "title": "awswaf-*",
        "fields": "[{\"name\":\"_id\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":false},{\"name\":\"_index\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":false},{\"name\":\"_score\",\"type\":\"number\",\"count\":0,\"scripted\":false,\"searchable\":false,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"_source\",\"type\":\"_source\",\"count\":0,\"scripted\":false,\"searchable\":false,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"_type\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":false},{\"name\":\"action\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"action.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"formatVersion\",\"type\":\"number\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpRequest.args\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"httpRequest.args.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpRequest.clientIp\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpRequest.clientIp.keyword\",\"type\":\"ip\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpRequest.country\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"httpRequest.country.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpRequest.headers.name\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"httpRequest.headers.name.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpRequest.headers.value\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"httpRequest.headers.value.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpRequest.httpMethod\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"httpRequest.httpMethod.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpRequest.httpVersion\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"httpRequest.httpVersion.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpRequest.uri\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"httpRequest.uri.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpSourceId\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"httpSourceId.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"httpSourceName\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"httpSourceName.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"terminatingRuleId\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"terminatingRuleId.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"terminatingRuleType\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"terminatingRuleType.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"timestamp\",\"type\":\"date\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"webaclId\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":false,\"readFromDocValues\":false},{\"name\":\"webaclId.keyword\",\"type\":\"string\",\"count\":0,\"scripted\":false,\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":true},{\"name\":\"webaclname\",\"type\":\"string\",\"count\":1,\"scripted\":true,\"script\":\"def webacl = doc['webaclId.keyword'].value;\\n\\n WEBACL_CUSTOM_MAPPINGS \\n\\n\\n return webacl;\\n\",\"lang\":\"painless\",\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":false},{\"name\":\"rulename\",\"type\":\"string\",\"count\":1,\"scripted\":true,\"script\":\"def rule = doc['terminatingRuleId.keyword'].value;\\n\\n RULE_CUSTOM_MAPPINGS \\n\\n\\n return rule;\\n\",\"lang\":\"painless\",\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":false},{\"name\":\"Host\",\"type\":\"string\",\"count\":1,\"scripted\":true,\"script\":\"def header_name;\\nfor(int i=0; i<params._source.httpRequest.headers.length; i++) { \\nheader_name = params._source.httpRequest.headers[i].name;\\n\\nif (header_name == \\\"Host\\\") {\\nreturn params._source.httpRequest.headers[i].value\\n}\\n}\\n\",\"lang\":\"painless\",\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":false},{\"name\":\"UserAgent\",\"type\":\"string\",\"count\":1,\"scripted\":true,\"script\":\"def header_name;\\nfor(int i=0; i<params._source.httpRequest.headers.length; i++) { \\nheader_name = params._source.httpRequest.headers[i].name.toLowerCase();\\n\\nif (header_name == \\\"user-agent\\\") {\\nreturn params._source.httpRequest.headers[i].value\\n}\\n}\\n\",\"lang\":\"painless\",\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":false}, {\"name\":\"Device-ID-A\",\"type\":\"string\",\"count\":0,\"scripted\":true,\"script\":\"def header_name;\\r\\nfor(int i=0; i<params._source.httpRequest.headers.length; i++) {\\r\\n    header_name = params._source.httpRequest.headers[i].name.toLowerCase();\\r\\n    if (header_name == \\\"cookie\\\") {\\r\\n        def m = /(?<=_imp_di_pc_=).*;/.matcher(params._source.httpRequest.headers[i].value);\\r\\n        if (m.find()) { return m.group(0) }\\r\\n        else { return \\\"no device-id found\\\" } \\r\\n    }\\r\\n}\",\"lang\":\"painless\",\"searchable\":true,\"aggregatable\":true,\"readFromDocValues\":false}]"
      }
    },
    {
      "type": "visualization",
      "id": "Top 10 Device-IdA",
      "attributes": {
        "title": "Top 10 Device-IdA",
        "visState": "{\"title\":\"Top 10 Device-IdA\",\"type\":\"table\",\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\"},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"Device-ID-A\",\"size\":10,\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Device-ID-A\"}}]}",
        "uiStateJSON": "{\"vis\":{\"params\":{\"sort\":{\"columnIndex\":null,\"direction\":null}}}}",
        "description": "",
        "version": 1,
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"index\":\"awswaf\",\"query\":{\"query\":\"\",\"language\":\"lucene\"},\"filter\":[]}"
        }
      }
    },
    {
        "type": "dashboard",
        "id": "WAFDashboard",
        "attributes": {
          "title": "WAFDashboard",
          "hits": 0,
          "description": "",
          "panelsJSON": "[{\"embeddableConfig\":{},\"gridData\":{\"h\":16,\"i\":\"1\",\"w\":8,\"x\":21,\"y\":53},\"id\":\"top10ip\",\"panelIndex\":\"1\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":5,\"i\":\"2\",\"w\":8,\"x\":15,\"y\":0},\"id\":\"numberofallrequests\",\"panelIndex\":\"2\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":5,\"i\":\"3\",\"w\":8,\"x\":15,\"y\":5},\"id\":\"numberofblockedrequests\",\"panelIndex\":\"3\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":10,\"i\":\"4\",\"w\":25,\"x\":23,\"y\":0},\"id\":\"allvsblockedrequests\",\"panelIndex\":\"4\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":17,\"i\":\"6\",\"w\":48,\"x\":0,\"y\":19},\"id\":\"allcountries\",\"panelIndex\":\"6\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":10,\"i\":\"8\",\"w\":15,\"x\":0,\"y\":0},\"id\":\"executedrules\",\"panelIndex\":\"8\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":9,\"i\":\"9\",\"w\":48,\"x\":0,\"y\":10},\"id\":\"filters\",\"panelIndex\":\"9\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":16,\"i\":\"10\",\"w\":8,\"x\":29,\"y\":53},\"id\":\"top10countries\",\"panelIndex\":\"10\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":16,\"i\":\"11\",\"w\":21,\"x\":0,\"y\":69},\"id\":\"top10useragents\",\"panelIndex\":\"11\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":9,\"i\":\"12\",\"w\":20,\"x\":0,\"y\":36},\"id\":\"httpmethods\",\"panelIndex\":\"12\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":9,\"i\":\"13\",\"w\":19,\"x\":20,\"y\":36},\"id\":\"httpversions\",\"panelIndex\":\"13\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":9,\"i\":\"14\",\"w\":9,\"x\":39,\"y\":36},\"id\":\"uniqueipcount\",\"panelIndex\":\"14\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":8,\"i\":\"15\",\"w\":48,\"x\":0,\"y\":45},\"id\":\"requestcount\",\"panelIndex\":\"15\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":16,\"i\":\"16\",\"w\":16,\"x\":21,\"y\":69},\"id\":\"top10hosts\",\"panelIndex\":\"16\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":16,\"i\":\"17\",\"w\":11,\"x\":37,\"y\":53},\"id\":\"top10webacl\",\"panelIndex\":\"17\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":16,\"i\":\"18\",\"w\":11,\"x\":37,\"y\":69},\"id\":\"top10rules\",\"panelIndex\":\"18\",\"type\":\"visualization\",\"version\":\"6.7.0\"},{\"embeddableConfig\":{},\"gridData\":{\"h\":16,\"i\":\"19\",\"w\":21,\"x\":0,\"y\":53},\"id\":\"top10uris\",\"panelIndex\":\"19\",\"type\":\"visualization\",\"version\":\"6.7.0\"}]",
          "optionsJSON": "{\"darkTheme\":false,\"hidePanelTitles\":false,\"useMargins\":true}",
          "version": 1,
          "timeRestore": false,
          "kibanaSavedObjectMeta": {
            "searchSourceJSON": "{\"query\":{\"language\":\"lucene\",\"query\":\"\"},\"filter\":[{\"meta\":{\"index\":\"awswaf\",\"negate\":true,\"disabled\":true,\"alias\":\"Default Action\",\"type\":\"phrase\",\"key\":\"terminatingRuleId.keyword\",\"value\":\"Default_Action\",\"params\":{\"query\":\"Default_Action\",\"type\":\"phrase\"}},\"query\":{\"match\":{\"terminatingRuleId.keyword\":{\"query\":\"Default_Action\",\"type\":\"phrase\"}}},\"$state\":{\"store\":\"appState\"}}]}"
          }
         }
     }     
  ]