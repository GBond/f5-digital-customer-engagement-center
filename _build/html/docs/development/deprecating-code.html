<!DOCTYPE html>
<div id="clouddocs-header">
  <div class="container-fluid">
    <div class="row corp-header">
      <div class="container corp-header">
        <div class="container corp-menu">
          <ul>
            <li><a href="https://f5.com" class="internalLink">F5.com</a></li>
            <li><a href="https://github.com/F5Networks" class="externalLink">GitHub</a></li>
            <li><a href="https://devcentral.f5.com" class="internalLink">Devcentral</a></li>
            <li><a href="https://support.f5.com" class="internalLink">Support</a></li>
          </ul>
        </div>
      </div>
    </div>

    <script async="async"
      src="https://consent.trustarc.com/notice?domain=f5.com&amp;c=teconsent&amp;text=true&amp;gtm=1" crossorigin=""
      id="truste_0.12182038258598205"></script>

    <div class="row pageHeader">
      <div class="container stat">
        <div class="col-xs-12 stat">
          <a class="internalLink" href="https://f5.com">
            <img class="logo" src="https://cdn.f5.com/websites/support/assets/images/logo.svg" width="50" height="44"
              alt="F5 Networks" title="F5 Networks" border="0">
          </a>
          <ul id="MainMenu" class="main-menu">
            <li data-submenu-id="products">
              <a data-link-type="nav: main" href="#" class="currentURL">Products
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>
              <div class="menu-panel soft-hide" id="products-submenu">
                <div class="container">
                  <ul class="submenu">
                    <li>
                      <span class="a-mm-h">BIG-IP Extensibility</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-appsvcs-extension/latest" data-link-type="Nav: Mega">F5
                            Application Services Extension 3</a></li>
                        <li><a href="https://clouddocs.f5.com/products/agc/latest" data-link-type="Nav: Mega">BIG-IP APM Access Guided
                            Configuration</a></li>
                        <li><a href="https://clouddocs.f5.com/products/iapp/iapp-lx/latest" data-link-type="Nav: Mega">iApps LX/iControl LX</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-declarative-onboarding/latest"
                            data-link-type="Nav: Mega">F5 Declarative Onboarding</a></li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-telemetry-streaming/latest" data-link-type="Nav: Mega">F5
                            Telemetry Streaming</a></li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-cloud-failover/latest" data-link-type="Nav: Mega">F5 Cloud
                            Failover</a></li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-appsvcs-templates/latest/" data-link-type="Nav: Mega">F5
                            Application Services Templates</a></li>
                      </ul>
                    </li>


                    <li class="divider"></li>
                    <li><span class="a-mm-h">Container Ingress Services</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/containers/latest/" data-link-type="Nav: Mega">F5 BIG-IP Controller for
                            Kubernetes/OpenShift</a></li>
                      </ul>
                      <span class="a-mm-h">Network Function Virtualization</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/cloud/nfv/latest" data-link-type="Nav: Mega">F5 VNF Manager</a></li>
                      </ul>
                      <span class="a-mm-h">SDK</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/sdk/f5-cli" target="_blank">F5 CLI</a></li>
                        <li><a href="https://clouddocs.f5.com/sdk/f5-sdk-python" target="_blank">F5 SDK Python</a></li>
                      </ul>
                    </li>



                    <li class="divider"></li>
                    <li>
                      <span class="a-mm-h">OpenStack</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/openstack/agent/latest" data-link-type="Nav: Mega">F5 Agent - OpenStack
                            Neutron</a></li>
                        <li><a href="https://clouddocs.f5.com/products/openstack/lbaasv2-driver/latest" data-link-type="Nav: Mega">F5 Driver -
                            OpenStack LBaaS</a></li>
                        <li><a href="https://clouddocs.f5.com/products/openstack/heat-plugins/latest" data-link-type="Nav: Mega">F5 Plugins -
                            OpenStack Heat</a></li>
                      </ul>

                      <span class="a-mm-h">Ecosystems Integrations</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/f5-aci-servicecenter/latest" data-link-type="Nav: Mega">F5 ACI ServiceCenter</a>
                        </li>
                      </ul>


                    </li>
                    <li class="divider"></li>
                    <li><span class="a-mm-h">Orchestration</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/orchestration/ansible/devel" target="_blank">F5 Modules for Ansible</a>
                        </li>
                        <li><a href="https://github.com/F5Networks/f5-aws-cloudformation" target="_blank"
                            class="externalLink">F5 Templates for AWS CloudFormation</a> (GitHub)</li>
                        <li><a href="https://github.com/F5Networks/f5-azure-arm-templates" target="_blank"
                            class="externalLink">F5 Templates for Azure ARM</a> (GitHub)</li>
                        <li><a href="https://github.com/F5Networks/f5-google-gdm-templates" target="_blank"
                            class="externalLink">F5 Templates for Google Cloud Deployment Manager</a> (GitHub)</li>
                        <li><a href="https://clouddocs.f5.com/products/templates/openstack-heat/latest" data-link-type="Nav: Mega">F5 Templates
                            for OpenStack Heat</a></li>
                        <li><a href="https://clouddocs.f5.com/products/orchestration/terraform/latest/" data-link-type="Nav: Mega">F5 Resources
                            for Terraform Provider</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </li>

            <!--- NEW -->
            <li>
              <a href="#" class="currentURL">APIs
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>

              <div class="menu-panel soft-hide" id="APISubmenu">
                <div class="container">
                  <ul class="submenu">
                    <li>
                      <span class="a-mm-h"></span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/big-iq/mgmt-api/latest/" data-link-type="Nav: Mega">F5 BIG-IQ API</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/api/iapps/">F5 BIG-IP iApps</a></li>
                        <li><a href="https://clouddocs.f5.com/api/irules">F5 BIG-IP iRules API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/irules-lx">F5 BIG-IP iRulesLX API</a></li>
                      </ul>
                    </li>

                    <li class="divider"></li>

                    <li>
                      <span class="a-mm-h"></span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/api/icontrol-rest">F5 BIG-IP iControlREST API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/icontrol-soap/">F5 BIG-IP iControl API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/ihealth/">F5 iHealth API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/tmsh">F5 tmsh scripting API</a></li>
                      </ul>
                    </li>

                  </ul>
                </div>
              </div>
            </li>




            <li>
              <a href="#" class="currentURL">Cloud &amp; Container
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>

              <div class="menu-panel soft-hide" id="ContainersSubmenu">
                <div class="container">
                  <ul class="submenu col-sm-11">
                    <li class="third"><span class="a-mm-h">Cloud Services</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-GS-About.html"
                            data-link-type="Nav: Mega">Get Started</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-Beacon-About.html"
                            data-link-type="Nav: Mega">Beacon</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-DNS-About.html"
                            data-link-type="Nav: Mega">DNS Cloud Service</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-GSLB-About.html"
                            data-link-type="Nav: Mega">DNS Load Balancer Cloud Service</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-Essential.App.Protect-About.html"
                            data-link-type="Nav: Mega">Essential App Protect Service</a></li>
                      </ul>
                    </li>
                    <li class="divider"></li>
                    <li class="third"><span class="a-mm-h">Clouds</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/cloud/public/v1/aws_index.html" data-link-type="Nav: Mega">AWS</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud/public/v1/azure_index.html" data-link-type="Nav: Mega">Azure</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud/public/v1/google_index.html" data-link-type="Nav: Mega">Google Cloud</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/cloud/openstack/" data-link-type="Nav: Mega">OpenStack</a></li>
                      </ul>
                      <!-- unnecessary right now>
                    <span class="seemore"><a data-link-type="Nav: Mega" href="/cloud/">See all </a></span>
                    <-->
                    </li>
                    <li class="divider"></li>
                    <li class="third"><span class="a-mm-h">Containers</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/containers/latest/userguide/kubernetes/" data-link-type="Nav: Mega">Kubernetes</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/containers/latest/userguide/openshift/" data-link-type="Nav: Mega">OpenShift</a>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </li>
            <li>
              <a href="#" class="currentURL">Resources
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>
              <div class="menu-panel soft-hide" id="UPCProgramSubmenu">
                <div class="container">
                  <ul class="submenu col-sm-11">
                    <li class="third">
                      <span class="a-mm-h">Downloads</span>
                      <ul>
                        <li><a target="_blank" data-link-type="Nav: Mega" href="https://hub.docker.com/r/f5networks/"
                            class="internalLink externalLink">Docker Hub</a></li>
                        <li><a target="_blank" data-link-type="Nav: Mega"
                            href="https://store.docker.com/images/f5networks-asp"
                            class="internalLink externalLink">Docker Store</a></li>
                      </ul>
                      <span class="a-mm-h">OpenSource</span>
                      <ul>
                        <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5Networks"
                            class="internalLink externalLink">F5Networks on GitHub</a></li>
                        <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5DevCentral"
                            class="internalLink externalLink">F5DevCentral on GitHub</a></li>
                      </ul>
                    </li>
                    <li class="divider"></li>
                    <li class="third">
                      <span class="a-mm-h">Training &amp; Labs</span>
                      <ul>
                        <li>
                          <p>Learn how to get the most out of the F5 platform</p>
                        </li>
                        <li><a href="https://clouddocs.f5.com/training/community">Community</a></li>
                      </ul>
                    </li>
                    <li class="divider"></li>

                    <li class="third">
                      <a href="//university.f5.com" class="a-mm-h internalLink" target="_blank"
                        data-link-type="Nav: Mega">F5 University</a>
                      <ul>
                        <li>
                          <p>Get up to speed with free self-paced courses</p>
                        </li>
                      </ul>
                      <a data-ng-href="https://devcentral.f5.com" class="a-mm-h internalLink" target="_blank"
                        data-link-type="Nav: Mega" href="https://devcentral.f5.com">DevCentral</a>
                      <ul>
                        <li>
                          <p>Join the community of 250,000+ technical peers</p>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </li>
          </ul>
        </div>

        <div class="col-xs-12 stat">
          <div class="topLinks">
            <span class="glyphicon glyphicon-search upc-search" id="search-toggle" style="display: none;"></span>
          </div>
        </div>
      </div>
    </div>
  </div> <!-- /container-fluid -->
</div>
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deprecating functionality &#8212; F5 Digital Customer Engagement Center 0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

  
    

  
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="dismiss">
      <button type="button" class="btn btn-info navbar-btn site-hidden">
        <i class="fa fa-align-justify"></i>
      </button>
    </div>
    <div id="sidebar" class="section-nav">
      
      <nav class="nav-sidebartoc">

        
        <h5>F5 Digital Customer Engagement Center 0.1 </h5>
        
<div id="searchbox" role="search">
  <form class="search" action="../../search.html" method="get">
    <input type="text" class="search" name="q" placeholder=" Search..." />
    <button type="submit" class="btn btn-info navbar-btn"><i class="fa fa-search"></i></button>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        <hr>
        <h5>Current Page</h5>
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Deprecating functionality</a><ul>
<li><a class="reference internal" href="#deprecating-modules">Deprecating modules</a></li>
<li><a class="reference internal" href="#deprecation-process">Deprecation process</a></li>
<li><a class="reference internal" href="#raise-deprecated-warnings">Raise deprecated warnings</a></li>
<li><a class="reference internal" href="#deprecating-parameters">Deprecating parameters</a></li>
<li><a class="reference internal" href="#deprecating-choices">Deprecating choices</a></li>
<li><a class="reference internal" href="#custom-deprecations">Custom deprecations</a></li>
</ul>
</li>
</ul>

         </span>
        <hr>
        <h5>Site Contents</h5>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/getting_started.html">Getting started</a></li>
</ul>
<p class="caption"><span class="caption-text">Solutions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../solutions/delivery/delivery_index.html">Application Delivery controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions/security/security_index.html">Security</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting-involved.html">How to get involved</a></li>
<li class="toctree-l1"><a class="reference internal" href="guidelines.html">Guidelines</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>

  
  <div class="main active" id="content">
    <article class="docs-container site-article-inner">
            <nav class="site-breadcrumb-nav site-nav">
          <ul class="site-breadcrumb-list">
            <li class="breadcrumb-item"><button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>&#x20 <a href="/">CloudDocs Home</a> &gt; <a href="../../index.html">F5 Digital Customer Engagement Center </a> &gt; Deprecating functionality</li>
          </ul>
      </nav>
      

    
  <div class="section" id="deprecating-functionality">
<h1>Deprecating functionality<a class="headerlink" href="#deprecating-functionality" title="Permalink to this headline">¶</a></h1>
<div class="section" id="deprecating-modules">
<h2>Deprecating modules<a class="headerlink" href="#deprecating-modules" title="Permalink to this headline">¶</a></h2>
<p>F5 sometimes deprecates modules. Before the modules go away, you should have enough time to upgrade to a new version of Ansible.</p>
<p>New releases of Ansible happen approximately once per quarter.</p>
<p>With this in mind, the following process should allow you between three and six months to upgrade your Ansible installation to the new code.</p>
<p>If you miss this timeframe, you can upgrade incrementally (2.1 -&gt; 2.2 -&gt; 2.3) instead of upgrading directly to the latest version and, in the process, test that the incremental versions work with your playbooks.</p>
</div>
<div class="section" id="deprecation-process">
<h2>Deprecation process<a class="headerlink" href="#deprecation-process" title="Permalink to this headline">¶</a></h2>
<p>Here is a sample deprecation process:</p>
<ul class="simple">
<li><p>2.0 - version to deprecate</p></li>
<li><p>2.1 - deprecated version</p></li>
<li><p>2.2 - version with deprecated feature removed</p></li>
</ul>
<p>During the second release, you <em>MUST</em> insert adequate warnings for the user to see. Ansible highlights warning messages so that they’re more visible than regular messages.</p>
</div>
<div class="section" id="raise-deprecated-warnings">
<h2>Raise deprecated warnings<a class="headerlink" href="#raise-deprecated-warnings" title="Permalink to this headline">¶</a></h2>
<p>To raise warnings about deprecated functionality, add the following method to your <cite>ModuleManager</cite> class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_announce_deprecations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="n">warnings</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__warnings&#39;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">for</span> <span class="n">warning</span> <span class="ow">in</span> <span class="n">warnings</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">deprecate</span><span class="p">(</span>
            <span class="n">msg</span><span class="o">=</span><span class="n">warning</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">],</span>
            <span class="n">version</span><span class="o">=</span><span class="n">warning</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>Additionally, you should call that method when you collect the <cite>changes</cite> to report to the user. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">changes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">changes</span><span class="o">.</span><span class="n">to_return</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">changes</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">changed</span><span class="o">=</span><span class="n">changed</span><span class="p">))</span>
<span class="bp">self</span><span class="o">.</span><span class="n">_announce_deprecations</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>And finally, you should populate the <cite>__warnings</cite> key of your <cite>changes</cite> attribute as needed.</p>
<p>For example, in the <cite>bigip_gtm_wide_ip</cite> module, the <cite>lb_method</cite> property uses this code when it sees you are using a deprecated option.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="s1">&#39;__warnings&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="s1">&#39;__warnings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="s1">&#39;__warnings&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;The provided lb_method is deprecated&#39;</span><span class="p">,</span>
            <span class="n">version</span><span class="o">=</span><span class="s1">&#39;2.4&#39;</span>
        <span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <cite>changes</cite> attribute is typically updated during the call to <cite>_update_changed_options</cite>, during <cite>update</cite>, or <cite>_set_changed_options</cite> during <cite>create</cite>.</p>
<p>If your module needs to detect changes outside of those two general methods, you should do so inside of the <cite>should_update</cite> method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To do your own ad-hoc detection inside of <cite>should_update</cite>, you must overload the base classes’ method. If you do this, you should decide whether or not it is still necessary to call the base classes’ method during the call to your overloaded method.</p>
</div>
<p>With that in place, you will find yourself with <cite>warning</cite> messages raised by Ansible when you use the deprecated functionality.</p>
</div>
<div class="section" id="deprecating-parameters">
<h2>Deprecating parameters<a class="headerlink" href="#deprecating-parameters" title="Permalink to this headline">¶</a></h2>
<p>Below is an excerpt that shows how you might deprecate an option you no longer want to use. You may do this for a number of reasons, but in most cases it is because the original name does not make sense in the context you’re using it in.</p>
<p>For example, you might have named the original option <cite>rules</cite>, when the more appropriate name for the option would have been <cite>irules</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ansible allows for aliasing of options so that specifying one is equivalent to specifying another. This is <em>not</em> the situation that we are referring to here. It is still perfectly acceptable to use option aliases if you want to. These guidelines are for when you specifically want to <em>remove</em> options that are presumably already in use.</p>
</div>
<p>Here is a sample <cite>ArgumentSpec</cite> from the version where we made the mistake. Let’s assume we made this mistake in version 2.0.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArgumentSpec</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">supports_check_mode</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">argument_spec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">rules</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">aliases</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;wide_ip&#39;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f5_product_name</span> <span class="o">=</span> <span class="s1">&#39;bigip&#39;</span>
</pre></div>
</div>
<p>Now, we wish to deprecate that option name. In version 2.1 of Ansible, we would do something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArgumentSpec</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">supports_check_mode</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">argument_spec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">rules</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">),</span>
            <span class="n">irules</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">aliases</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;wide_ip&#39;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f5_product_name</span> <span class="o">=</span> <span class="s1">&#39;bigip&#39;</span>
</pre></div>
</div>
<p>Additionally, we would include the warnings necessary to make the user aware that they are using deprecated functionality (the <cite>rules</cite> option).</p>
<p>Finally, during the release cycle of Ansible 2.2, we would want to change our spec to look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArgumentSpec</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">supports_check_mode</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">argument_spec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">irules</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">aliases</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;wide_ip&#39;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f5_product_name</span> <span class="o">=</span> <span class="s1">&#39;bigip&#39;</span>
</pre></div>
</div>
<p>This removes the deprecated functionality.</p>
<p>Also, do not forget to remove any mention of the deprecation inside the actual module code. We don’t want the legacy code to stick around. This helps keep technical debt at bay.</p>
</div>
<div class="section" id="deprecating-choices">
<h2>Deprecating choices<a class="headerlink" href="#deprecating-choices" title="Permalink to this headline">¶</a></h2>
<p>When functionality is deprecated, it may be necessary to raise warnings to the user.</p>
<p>Normally, you do deprecations in the ArgumentSpec. For example, when you use <cite>removed_in_version</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">removed_in_version</span><span class="o">=</span><span class="s1">&#39;2.4&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This is only relevant when the <strong>parameter itself</strong> is deprecated.</p>
<p>Sometimes the parameter is a list of choices and the <strong>choices themselves</strong> are deprecated.</p>
<p>For example, consider the following parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;foo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;bar_2&#39;</span><span class="p">,</span> <span class="s1">&#39;baz_3&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You may need to deprecate the values themselves in favor of other values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;foo-1&#39;</span><span class="p">,</span> <span class="s1">&#39;bar-2&#39;</span><span class="p">,</span> <span class="s1">&#39;baz-3&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This may seem like a simple thing that you could add code to fix, but doing so would increase technical debt.</p>
<p>Mapping old values to new values is a candidate for deprecation.</p>
</div>
<div class="section" id="custom-deprecations">
<h2>Custom deprecations<a class="headerlink" href="#custom-deprecations" title="Permalink to this headline">¶</a></h2>
<p>To announce deprecations, you can use the <cite>removed_in_version</cite> field mentioned previously, but your module can also raise more customized deprecations.</p>
<p>To do this, begin by amending the <cite>__init__</cite> method of your <cite>Parameters</cite> class to define a <cite>__warnings</cite> variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Parameters</span><span class="p">(</span><span class="n">AnsibleF5Parameters</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Parameters</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="s1">&#39;__warnings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<p>Next, add a new method to the <cite>ModuleManager</cite>, or, class-specific manager (such as those used when forking logic, like <cite>bigip_gtm_pool</cite>).</p>
<p>The definition of this method is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_announce_deprecations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="p">:</span>
        <span class="n">warnings</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;__warnings&#39;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">have</span><span class="p">:</span>
        <span class="n">warnings</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">have</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;__warnings&#39;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">for</span> <span class="n">warning</span> <span class="ow">in</span> <span class="n">warnings</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">deprecate</span><span class="p">(</span>
            <span class="n">msg</span><span class="o">=</span><span class="n">warning</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">],</span>
            <span class="n">version</span><span class="o">=</span><span class="n">warning</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>The third and final step is to actually make use of the deprecation code that you set up previously. To do that, you want to <strong>append</strong> to the aforementioned <cite>__warnings</cite> field.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">lb_method</span> <span class="ow">in</span> <span class="n">deprecated</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="s1">&#39;__warnings&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="s1">&#39;__warnings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="s1">&#39;__warnings&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;The provided lb_method is deprecated&#39;</span><span class="p">,</span>
                <span class="n">version</span><span class="o">=</span><span class="s1">&#39;2.4&#39;</span>
            <span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/bootstrap.min.js"></script>
  <script src="../../_static/js/clouddocs.js"></script>
  </body>
</html>