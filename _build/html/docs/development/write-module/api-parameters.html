<!DOCTYPE html>
<div id="clouddocs-header">
  <div class="container-fluid">
    <div class="row corp-header">
      <div class="container corp-header">
        <div class="container corp-menu">
          <ul>
            <li><a href="https://f5.com" class="internalLink">F5.com</a></li>
            <li><a href="https://github.com/F5Networks" class="externalLink">GitHub</a></li>
            <li><a href="https://devcentral.f5.com" class="internalLink">Devcentral</a></li>
            <li><a href="https://support.f5.com" class="internalLink">Support</a></li>
          </ul>
        </div>
      </div>
    </div>

    <script async="async"
      src="https://consent.trustarc.com/notice?domain=f5.com&amp;c=teconsent&amp;text=true&amp;gtm=1" crossorigin=""
      id="truste_0.12182038258598205"></script>

    <div class="row pageHeader">
      <div class="container stat">
        <div class="col-xs-12 stat">
          <a class="internalLink" href="https://f5.com">
            <img class="logo" src="https://cdn.f5.com/websites/support/assets/images/logo.svg" width="50" height="44"
              alt="F5 Networks" title="F5 Networks" border="0">
          </a>
          <ul id="MainMenu" class="main-menu">
            <li data-submenu-id="products">
              <a data-link-type="nav: main" href="#" class="currentURL">Products
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>
              <div class="menu-panel soft-hide" id="products-submenu">
                <div class="container">
                  <ul class="submenu">
                    <li>
                      <span class="a-mm-h">BIG-IP Extensibility</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-appsvcs-extension/latest" data-link-type="Nav: Mega">F5
                            Application Services Extension 3</a></li>
                        <li><a href="https://clouddocs.f5.com/products/agc/latest" data-link-type="Nav: Mega">BIG-IP APM Access Guided
                            Configuration</a></li>
                        <li><a href="https://clouddocs.f5.com/products/iapp/iapp-lx/latest" data-link-type="Nav: Mega">iApps LX/iControl LX</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-declarative-onboarding/latest"
                            data-link-type="Nav: Mega">F5 Declarative Onboarding</a></li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-telemetry-streaming/latest" data-link-type="Nav: Mega">F5
                            Telemetry Streaming</a></li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-cloud-failover/latest" data-link-type="Nav: Mega">F5 Cloud
                            Failover</a></li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-appsvcs-templates/latest/" data-link-type="Nav: Mega">F5
                            Application Services Templates</a></li>
                      </ul>
                    </li>


                    <li class="divider"></li>
                    <li><span class="a-mm-h">Container Ingress Services</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/containers/latest/" data-link-type="Nav: Mega">F5 BIG-IP Controller for
                            Kubernetes/OpenShift</a></li>
                      </ul>
                      <span class="a-mm-h">Network Function Virtualization</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/cloud/nfv/latest" data-link-type="Nav: Mega">F5 VNF Manager</a></li>
                      </ul>
                      <span class="a-mm-h">SDK</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/sdk/f5-cli" target="_blank">F5 CLI</a></li>
                        <li><a href="https://clouddocs.f5.com/sdk/f5-sdk-python" target="_blank">F5 SDK Python</a></li>
                      </ul>
                    </li>



                    <li class="divider"></li>
                    <li>
                      <span class="a-mm-h">OpenStack</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/openstack/agent/latest" data-link-type="Nav: Mega">F5 Agent - OpenStack
                            Neutron</a></li>
                        <li><a href="https://clouddocs.f5.com/products/openstack/lbaasv2-driver/latest" data-link-type="Nav: Mega">F5 Driver -
                            OpenStack LBaaS</a></li>
                        <li><a href="https://clouddocs.f5.com/products/openstack/heat-plugins/latest" data-link-type="Nav: Mega">F5 Plugins -
                            OpenStack Heat</a></li>
                      </ul>

                      <span class="a-mm-h">Ecosystems Integrations</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/f5-aci-servicecenter/latest" data-link-type="Nav: Mega">F5 ACI ServiceCenter</a>
                        </li>
                      </ul>


                    </li>
                    <li class="divider"></li>
                    <li><span class="a-mm-h">Orchestration</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/orchestration/ansible/devel" target="_blank">F5 Modules for Ansible</a>
                        </li>
                        <li><a href="https://github.com/F5Networks/f5-aws-cloudformation" target="_blank"
                            class="externalLink">F5 Templates for AWS CloudFormation</a> (GitHub)</li>
                        <li><a href="https://github.com/F5Networks/f5-azure-arm-templates" target="_blank"
                            class="externalLink">F5 Templates for Azure ARM</a> (GitHub)</li>
                        <li><a href="https://github.com/F5Networks/f5-google-gdm-templates" target="_blank"
                            class="externalLink">F5 Templates for Google Cloud Deployment Manager</a> (GitHub)</li>
                        <li><a href="https://clouddocs.f5.com/products/templates/openstack-heat/latest" data-link-type="Nav: Mega">F5 Templates
                            for OpenStack Heat</a></li>
                        <li><a href="https://clouddocs.f5.com/products/orchestration/terraform/latest/" data-link-type="Nav: Mega">F5 Resources
                            for Terraform Provider</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </li>

            <!--- NEW -->
            <li>
              <a href="#" class="currentURL">APIs
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>

              <div class="menu-panel soft-hide" id="APISubmenu">
                <div class="container">
                  <ul class="submenu">
                    <li>
                      <span class="a-mm-h"></span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/big-iq/mgmt-api/latest/" data-link-type="Nav: Mega">F5 BIG-IQ API</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/api/iapps/">F5 BIG-IP iApps</a></li>
                        <li><a href="https://clouddocs.f5.com/api/irules">F5 BIG-IP iRules API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/irules-lx">F5 BIG-IP iRulesLX API</a></li>
                      </ul>
                    </li>

                    <li class="divider"></li>

                    <li>
                      <span class="a-mm-h"></span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/api/icontrol-rest">F5 BIG-IP iControlREST API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/icontrol-soap/">F5 BIG-IP iControl API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/ihealth/">F5 iHealth API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/tmsh">F5 tmsh scripting API</a></li>
                      </ul>
                    </li>

                  </ul>
                </div>
              </div>
            </li>




            <li>
              <a href="#" class="currentURL">Cloud &amp; Container
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>

              <div class="menu-panel soft-hide" id="ContainersSubmenu">
                <div class="container">
                  <ul class="submenu col-sm-11">
                    <li class="third"><span class="a-mm-h">Cloud Services</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-GS-About.html"
                            data-link-type="Nav: Mega">Get Started</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-Beacon-About.html"
                            data-link-type="Nav: Mega">Beacon</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-DNS-About.html"
                            data-link-type="Nav: Mega">DNS Cloud Service</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-GSLB-About.html"
                            data-link-type="Nav: Mega">DNS Load Balancer Cloud Service</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-Essential.App.Protect-About.html"
                            data-link-type="Nav: Mega">Essential App Protect Service</a></li>
                      </ul>
                    </li>
                    <li class="divider"></li>
                    <li class="third"><span class="a-mm-h">Clouds</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/cloud/public/v1/aws_index.html" data-link-type="Nav: Mega">AWS</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud/public/v1/azure_index.html" data-link-type="Nav: Mega">Azure</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud/public/v1/google_index.html" data-link-type="Nav: Mega">Google Cloud</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/cloud/openstack/" data-link-type="Nav: Mega">OpenStack</a></li>
                      </ul>
                      <!-- unnecessary right now>
                    <span class="seemore"><a data-link-type="Nav: Mega" href="/cloud/">See all </a></span>
                    <-->
                    </li>
                    <li class="divider"></li>
                    <li class="third"><span class="a-mm-h">Containers</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/containers/latest/userguide/kubernetes/" data-link-type="Nav: Mega">Kubernetes</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/containers/latest/userguide/openshift/" data-link-type="Nav: Mega">OpenShift</a>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </li>
            <li>
              <a href="#" class="currentURL">Resources
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>
              <div class="menu-panel soft-hide" id="UPCProgramSubmenu">
                <div class="container">
                  <ul class="submenu col-sm-11">
                    <li class="third">
                      <span class="a-mm-h">Downloads</span>
                      <ul>
                        <li><a target="_blank" data-link-type="Nav: Mega" href="https://hub.docker.com/r/f5networks/"
                            class="internalLink externalLink">Docker Hub</a></li>
                        <li><a target="_blank" data-link-type="Nav: Mega"
                            href="https://store.docker.com/images/f5networks-asp"
                            class="internalLink externalLink">Docker Store</a></li>
                      </ul>
                      <span class="a-mm-h">OpenSource</span>
                      <ul>
                        <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5Networks"
                            class="internalLink externalLink">F5Networks on GitHub</a></li>
                        <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5DevCentral"
                            class="internalLink externalLink">F5DevCentral on GitHub</a></li>
                      </ul>
                    </li>
                    <li class="divider"></li>
                    <li class="third">
                      <span class="a-mm-h">Training &amp; Labs</span>
                      <ul>
                        <li>
                          <p>Learn how to get the most out of the F5 platform</p>
                        </li>
                        <li><a href="https://clouddocs.f5.com/training/community">Community</a></li>
                      </ul>
                    </li>
                    <li class="divider"></li>

                    <li class="third">
                      <a href="//university.f5.com" class="a-mm-h internalLink" target="_blank"
                        data-link-type="Nav: Mega">F5 University</a>
                      <ul>
                        <li>
                          <p>Get up to speed with free self-paced courses</p>
                        </li>
                      </ul>
                      <a data-ng-href="https://devcentral.f5.com" class="a-mm-h internalLink" target="_blank"
                        data-link-type="Nav: Mega" href="https://devcentral.f5.com">DevCentral</a>
                      <ul>
                        <li>
                          <p>Join the community of 250,000+ technical peers</p>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </li>
          </ul>
        </div>

        <div class="col-xs-12 stat">
          <div class="topLinks">
            <span class="glyphicon glyphicon-search upc-search" id="search-toggle" style="display: none;"></span>
          </div>
        </div>
      </div>
    </div>
  </div> <!-- /container-fluid -->
</div>
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ApiParameters class &#8212; F5 Digital Customer Engagement Center 0.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />

  
    

  
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="dismiss">
      <button type="button" class="btn btn-info navbar-btn site-hidden">
        <i class="fa fa-align-justify"></i>
      </button>
    </div>
    <div id="sidebar" class="section-nav">
      
      <nav class="nav-sidebartoc">

        
        <h5>F5 Digital Customer Engagement Center 0.1 </h5>
        
<div id="searchbox" role="search">
  <form class="search" action="../../../search.html" method="get">
    <input type="text" class="search" name="q" placeholder=" Search..." />
    <button type="submit" class="btn btn-info navbar-btn"><i class="fa fa-search"></i></button>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        <hr>
        <h5>Current Page</h5>
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">ApiParameters class</a><ul>
<li><a class="reference internal" href="#internal-methods">Internal methods</a></li>
<li><a class="reference internal" href="#property-methods">&#64;property methods</a></li>
<li><a class="reference internal" href="#looking-deeper-into-an-property-method">Looking deeper into an &#64;property method</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

         </span>
        <hr>
        <h5>Site Contents</h5>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/getting_started.html">Getting started</a></li>
</ul>
<p class="caption"><span class="caption-text">Solutions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../solutions/delivery/delivery_index.html">Application Delivery controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solutions/security/security_index.html">Security</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-involved.html">How to get involved</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guidelines.html">Guidelines</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>

  
  <div class="main active" id="content">
    <article class="docs-container site-article-inner">
            <nav class="site-breadcrumb-nav site-nav">
          <ul class="site-breadcrumb-list">
            <li class="breadcrumb-item"><button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>&#x20 <a href="/">CloudDocs Home</a> &gt; <a href="../../../index.html">F5 Digital Customer Engagement Center </a> &gt; ApiParameters class</li>
          </ul>
      </nav>
      

    
  <div class="section" id="apiparameters-class">
<span id="api-parameters-label"></span><h1>ApiParameters class<a class="headerlink" href="#apiparameters-class" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">ApiParameters</span></code> class is one of two major Adapter-based classes that routinely appears
in the F5 Modules for Ansible. This class acts as a translation layer, or adapter
between the data received from the API and the data used in the module.</p>
<p>For this tutorial, you should <a class="reference external" href="https://github.com/F5Networks/f5-ansible/blob/stable-2.5/library/bigip_policy_rule.py#L271">navigate to the appropriate section</a> of the stable 2.5 source
code and copy it into your working module at the same location that it exists in the stable
branch.</p>
<p>The rest of this section discusses implementation details of this class.</p>
<div class="section" id="internal-methods">
<h2>Internal methods<a class="headerlink" href="#internal-methods" title="Permalink to this headline">¶</a></h2>
<p>Adapter classes like <code class="docutils literal notranslate"><span class="pre">ApiParameters</span></code> may have any number of internal methods added to them.</p>
<p>In this module’s implementation, the class has one method: <code class="docutils literal notranslate"><span class="pre">_remove_internal_keywords</span></code>.
Adding new internal methods is a great way to tease out common functionality that you may want to reuse across a wide variety of modules.</p>
<p>The quintessential example is the <code class="docutils literal notranslate"><span class="pre">fq_name</span></code> method. You know it is common, because if you
remember back to the <a class="reference internal" href="import-block.html"><span class="doc">import block</span></a> section, it was included in one of the imports:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ansible.module_utils.network.f5.common</span> <span class="kn">import</span> <span class="n">fq_name</span>
</pre></div>
</div>
<p>The history of this particular function goes back to the earliest days of the F5 module code.
In fact, its original implementation was not written by F5, but by customer contributors before
F5 ever became involved.</p>
<p>This method is used to combine a resource’s name and its partition. This behavior is
so common that it affects <em>every</em> resource on the device. Therefore, it was a great
candidate for inclusion in the common methods.</p>
<p>This same process of deducing what is common, and then re-using it across modules,
typically begins with internal methods.</p>
<p>Ansible’s means of supporting this inclusion is through the <code class="docutils literal notranslate"><span class="pre">module_utils</span></code> area of Ansible.</p>
<p>What should you do in situations where your method may apply to a small subset of modules, but not all
modules? It turns out that Ansible can support that too. The <code class="docutils literal notranslate"><span class="pre">module_utils</span></code> directory contains
a number of sub-directories; one of them is delegated for use by F5.</p>
<p>Inside F5’s directory (conveniently called <code class="docutils literal notranslate"><span class="pre">f5</span></code>), module developers may add more files for
use in common subsets of modules. Examples might be “the GTM modules”, or “the monitor modules.”
The combinations may vary, but including them is all the same.</p>
<p>Suppose there was a common function used in all monitor-related modules. This
function is only relevant to monitors though, so it makes no sense to include it in all
modules. The result is that the developer may create a new file in F5’s <code class="docutils literal notranslate"><span class="pre">module_utils</span></code>
directory called <code class="docutils literal notranslate"><span class="pre">monitors.py</span></code> and inside of that file, put the implementation of the
function.</p>
<p>Usage of this method could then be done in the monitor-related modules, like this.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ansible.module_utils.network.f5.monitors</span> <span class="kn">import</span> <span class="n">the_function</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">the_function</span></code> is replaced with the name of the function.</p>
<p>So by all means, write as many internal methods as you can.</p>
</div>
<div class="section" id="property-methods">
<h2>&#64;property methods<a class="headerlink" href="#property-methods" title="Permalink to this headline">¶</a></h2>
<p>When it comes right down to it, the entirety of the functionality of the <code class="docutils literal notranslate"><span class="pre">ApiParameters</span></code>
class is encapsulated in the numerous <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> methods that it exposes.</p>
<p>These methods are used whenever you call the name of the property via the <code class="docutils literal notranslate"><span class="pre">self.have</span></code> object.
This object <strong>is</strong> the <code class="docutils literal notranslate"><span class="pre">ApiParameters</span></code> class. You should make sure that you have as many
properties as needed to make your development easier.</p>
<p>There is an additional, special, piece of functionality that all <code class="docutils literal notranslate"><span class="pre">ApiParameters</span></code> inherit;
they can be populated by the <code class="docutils literal notranslate"><span class="pre">api_map</span></code>. If you’ll remember back to the previous section
on the base <code class="docutils literal notranslate"><span class="pre">Parameters</span></code> class, one of the top-of-class variables was the <code class="docutils literal notranslate"><span class="pre">api_map</span></code>
variable. The <code class="docutils literal notranslate"><span class="pre">ApiParameters</span></code> class is where this variable is most useful because it will
auto-map the API resource attribute name to the <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> you specify.</p>
<p>Some modules implement additional <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> methods that are neither mapped to the API
nor provided by the module user. The reason this is done (usually) is to get a simpler
view of data that either the API or the user provide. This simpler implementation is then used
for comparisons for validity checks.</p>
</div>
<div class="section" id="looking-deeper-into-an-property-method">
<h2>Looking deeper into an &#64;property method<a class="headerlink" href="#looking-deeper-into-an-property-method" title="Permalink to this headline">¶</a></h2>
<p>To illustrate an example of a <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> method, consider the <code class="docutils literal notranslate"><span class="pre">actions</span></code> property. The
implementation of this property is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">actions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="s1">&#39;actions&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="s1">&#39;items&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="s1">&#39;actions&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="s1">&#39;actions&#39;</span><span class="p">][</span><span class="s1">&#39;items&#39;</span><span class="p">]:</span>
        <span class="n">action</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_internal_keywords</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;forward&#39;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
            <span class="n">action</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">action</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span>
            <span class="k">del</span> <span class="n">action</span><span class="p">[</span><span class="s1">&#39;forward&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s1">&#39;enable&#39;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
            <span class="n">action</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">action</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;enable&#39;</span>
            <span class="k">del</span> <span class="n">action</span><span class="p">[</span><span class="s1">&#39;enable&#39;</span><span class="p">]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>Remember that the purpose of a the <code class="docutils literal notranslate"><span class="pre">ApiParameters</span></code> adapter is to take the content from the
API and translate it to something that is usable in the module.</p>
<p>The API representation of this action data is a list of dictionaries:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;kind&quot;</span><span class="o">:</span> <span class="s2">&quot;tm:ltm:policy:rules:actions:actionscollectionstate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;selfLink&quot;</span><span class="o">:</span> <span class="s2">&quot;https://localhost/mgmt/tm/ltm/policy/~Common~sdfg/rules/foo/actions?ver=13.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;kind&quot;</span><span class="o">:</span> <span class="s2">&quot;tm:ltm:policy:rules:actions:actionsstate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fullPath&quot;</span><span class="o">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;generation&quot;</span><span class="o">:</span> <span class="mf">62</span><span class="p">,</span>
            <span class="s2">&quot;selfLink&quot;</span><span class="o">:</span> <span class="s2">&quot;https://localhost/mgmt/tm/ltm/policy/~Common~sdfg/rules/foo/actions/0?ver=13.1.0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;code&quot;</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span>
            <span class="s2">&quot;expirySecs&quot;</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span>
            <span class="s2">&quot;forward&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="s2">&quot;length&quot;</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span>
            <span class="s2">&quot;offset&quot;</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span>
            <span class="s2">&quot;pool&quot;</span><span class="o">:</span> <span class="s2">&quot;/Common/dfgh&quot;</span><span class="p">,</span>
            <span class="s2">&quot;poolReference&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;link&quot;</span><span class="o">:</span> <span class="s2">&quot;https://localhost/mgmt/tm/ltm/pool/~Common~dfgh?ver=13.1.0&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;port&quot;</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span>
            <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="s2">&quot;select&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span>
            <span class="s2">&quot;timeout&quot;</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span>
            <span class="s2">&quot;vlanId&quot;</span><span class="o">:</span> <span class="mf">0</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The adapter needs to take this payload and turn it into something that the module can use.
A lot of thought needs to go into the “that the module can use” part, because there is no
prescribed way of handling data.</p>
<p>The developer of this module needed to know about what was stored in the API so that they could do an accurate comparison. These things were outlined back in
the <code class="docutils literal notranslate"><span class="pre">DOCUMENTATION</span></code> blob that you wrote. If you’ll remember, that data was the following:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">actions</span><span class="p">:</span>
  <span class="nt">description</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The actions that you want the policy rule to perform.</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The available attributes vary by the action, however, each action requires that</span>
      <span class="l l-Scalar l-Scalar-Plain">a C(type) be specified.</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">These conditions can be specified in any order. Despite them being a list, the</span>
      <span class="l l-Scalar l-Scalar-Plain">BIG-IP does not treat their order as anything special.</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Available C(type) values are C(forward).</span>
  <span class="nt">suboptions</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The action type. This value controls what below options are required.</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">When C(type) is C(forward), will associate a given C(pool) with this rule.</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">When C(type) is C(enable), will associate a given C(asm_policy) with</span>
          <span class="l l-Scalar l-Scalar-Plain">this rule.</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">When C(type) is C(ignore), will remove all existing actions from this</span>
          <span class="l l-Scalar l-Scalar-Plain">rule.</span>
      <span class="nt">required</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="nt">choices</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="s">&#39;forward&#39;</span><span class="p p-Indicator">,</span> <span class="s">&#39;enable&#39;</span><span class="p p-Indicator">,</span> <span class="s">&#39;ignore&#39;</span> <span class="p p-Indicator">]</span>
    <span class="nt">pool</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Pool that you want to forward traffic to.</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">This parameter is only valid with the C(forward) type.</span>
    <span class="nt">asm_policy</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ASM policy to enable.</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">This parameter is only valid with the C(enable) type.</span>
</pre></div>
</div>
<p>This documentation tells us that the module intends to receive an <code class="docutils literal notranslate"><span class="pre">actions</span></code> argument.
Inside this argument will be a list. Each item in the list will be a dictionary containing
a required <code class="docutils literal notranslate"><span class="pre">type</span></code> key, and then one of the two other keys: either <code class="docutils literal notranslate"><span class="pre">pool</span></code>, or
<code class="docutils literal notranslate"><span class="pre">asm_policy</span></code>.</p>
<p>So we know that the data we want to compare with should look something like this in terms
of its Python representation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">{</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pool&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span>
  <span class="p">},</span>
<span class="p">]</span>

<span class="ow">or</span>

<span class="p">[</span>
  <span class="p">{</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
    <span class="s1">&#39;asm_policy&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span>
  <span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Additionally, the data could possibly be a combination of the above, because policies allow
this. Perhaps something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">{</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pool&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
    <span class="s1">&#39;asm_policy&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span>
  <span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Python lets us compare dictionaries pretty easily using their tuple representations, so
let’s assume that we want to make the API data reflect the data structure shown above.</p>
<p>To do this, we need to know the <code class="docutils literal notranslate"><span class="pre">type</span></code>, and one of two values: either the <code class="docutils literal notranslate"><span class="pre">pool</span></code> or
<code class="docutils literal notranslate"><span class="pre">asm_policy</span></code>. It turns out that the action payload shown earlier actually contains this
information. Furthermore, we can see that the <code class="docutils literal notranslate"><span class="pre">actions</span></code> <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> converts the JSON
payload to a dict that resembles the intended data structure above.</p>
<p>First, because the module data structure wants a list, the method sets the <code class="docutils literal notranslate"><span class="pre">result</span></code> local
variable to a Python empty list. This allows the method to then add values to the list later.</p>
<p>Next, the method checks to see if either of two conditions are true:</p>
<ul class="simple">
<li><p>Is the <code class="docutils literal notranslate"><span class="pre">actions</span></code> attribute of the LTM policy rule missing? If it is, its value will be
Python’s <code class="docutils literal notranslate"><span class="pre">None</span></code> value.</p></li>
<li><p>Is the <code class="docutils literal notranslate"><span class="pre">actions</span></code> attribute missing the <code class="docutils literal notranslate"><span class="pre">items</span></code> key? Earlier, in the JSON payload, you
saw that the actions payload will have three top-level keys: <code class="docutils literal notranslate"><span class="pre">kind</span></code>, <code class="docutils literal notranslate"><span class="pre">selfLink</span></code>, and
<code class="docutils literal notranslate"><span class="pre">items</span></code>. If the <code class="docutils literal notranslate"><span class="pre">items</span></code> value is missing, then there are no actions to be taken.</p></li>
</ul>
<p>If either of the above conditions are met, the method immediately returns a single item list
with the one item being set to a dictionary with a <code class="docutils literal notranslate"><span class="pre">type</span></code> key whose value is <code class="docutils literal notranslate"><span class="pre">ignore</span></code>.
This is the internal representation for how the module detects an <code class="docutils literal notranslate"><span class="pre">ignore</span></code> type.</p>
<p>If the above does not happen, the method can safely assume that it has a number of actions
that need to be discovered and formatted into usable dictionaries.</p>
<p>On the <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">item...</span></code> line, it iterates over each of these <code class="docutils literal notranslate"><span class="pre">items</span></code>.</p>
<p>During iteration, the method will be determining the <code class="docutils literal notranslate"><span class="pre">actions</span></code> that can be deduced from
the original JSON payload. Therefore, it creates a new local variable named <code class="docutils literal notranslate"><span class="pre">actions</span></code> and
sets its value to an empty dictionary. If it is able to intuit actions from this payload,
they will go in this variable.</p>
<p>Next, the module removes any keywords that it deems internal, from the current action in
the <code class="docutils literal notranslate"><span class="pre">items</span></code> list.</p>
<p>After removing internal (i.e., useless to the module) keywords, the method makes a judgement
call about the <code class="docutils literal notranslate"><span class="pre">type</span></code>. This judgement call also says a lot about which <a href="#id1"><span class="problematic" id="id2">``</span></a>type``s the module
supports.</p>
<p>The two decisions are:</p>
<ul class="simple">
<li><p>Does the current action have an attribute named <code class="docutils literal notranslate"><span class="pre">forward</span></code>?</p></li>
<li><p>Does the current action have an attribute named <code class="docutils literal notranslate"><span class="pre">enable</span></code>?</p></li>
</ul>
<p>If either of those two rules is met, then the current action is added to the local <code class="docutils literal notranslate"><span class="pre">action</span></code>
variable, a <code class="docutils literal notranslate"><span class="pre">type</span></code> key is added that is specific to the <code class="docutils literal notranslate"><span class="pre">type</span></code> that the method found,
and the original key that was used to determine the type is deleted from the local action
variable. The last step is done to prevent any polluting of what is returned by the method.</p>
<p>Finally, the local action variable is appended to the local <code class="docutils literal notranslate"><span class="pre">result</span></code> list.</p>
<p>The final action of the method before returning the result to the caller is that it sorts
all of the entries in the local <code class="docutils literal notranslate"><span class="pre">result</span></code> variable by the <code class="docutils literal notranslate"><span class="pre">name</span></code> key of the item in the
<code class="docutils literal notranslate"><span class="pre">result</span></code> list.</p>
<p>This is a <strong>very important</strong> step because it ensures that any future comparisons will be
done on lists that are in the same order. When determining “difference,” it is not enough
to assume that all items in a list have the same value. <em>Order</em> of that list is just as
important in certain circumstances. Those circumstances are usually when the data on the
BIG-IP itself is <a href="#id3"><span class="problematic" id="id4">*</span></a>un*ordered.</p>
<p>If BIG-IP does not consider order important for a particular resource, then the module
developer <strong>must</strong> consider it important. This is because when there is no order, the users
are not expecting there to be any order, and therefore, can arrange things in any way they
want. For the module developer, this is a problem because all of the following are technically
the same:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>The module then, is responsible for assuming that all values can possibly be unordered, and
ordering them sanely for comparison.</p>
<p>Contrast this with a situation where the above <strong>is</strong> ordered. Then, each one of those lists
is a different value. And a comparison of one order would fail against another order– i.e., if
the customer changes the order of an ordered list, it implies their desire to change the
order of the values in the BIG-IP.</p>
<p>Rules in a policy are a great example of this. The <em>rules</em> have order. However the <em>actions</em>
and <em>conditions</em> in that rule have no order.</p>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Understanding and using the <code class="docutils literal notranslate"><span class="pre">ApiParameters</span></code> class is a core tenant of understanding
the F5 Modules for Ansible. From here, you may want to go back and consider exploring the
twin of this class (but which operates on the user’s side): the <code class="docutils literal notranslate"><span class="pre">ModuleParameters</span></code> class.</p>
</div>
</div>


    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../../_static/js/bootstrap.min.js"></script>
  <script src="../../../_static/js/clouddocs.js"></script>
  </body>
</html>